<div class="max-w-xl mx-auto mt-4 bg-white p-4">
  <%= form_with model: @delivery_inspection, local: true do |f| %>

    <div class="grid grid-cols-2 gap-x-5 gap-y-4 items-center">

     <!-- Delivery Date -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :delivery_date, "Delivery Date" %>
      </label>
      <div class="text-left">
        <%= f.date_field :delivery_date,
              value: f.object.delivery_date || Date.current,
              class: field_class_flex %>
        <%= field_error_for(@delivery_inspection, :delivery_date) %>
      </div>

      <!-- Item (select) -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :item, "Item" %>
      </label>
      <div class="text-left">
        <%= f.select :item,
                     options_for_select(dairy_ingredients, @delivery_inspection.item),
                     { prompt: "Select ingredient" },
                     { class: field_class_flex } %>
        <%= field_error_for(@delivery_inspection, :item) %>
      </div>

      <!-- Batch No -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :batch_no, "Batch No" %>
      </label>
      <div class="text-left">
        <%= f.text_field :batch_no, class: field_class_flex %>
        <%= field_error_for(@delivery_inspection, :batch_no) %>
      </div>

      <!-- Best Before -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :best_before, "Best Before" %>
      </label>
      <div class="text-left">
        <%= f.date_field :best_before, class: field_class_flex %>
        <%= field_error_for(@delivery_inspection, :best_before) %>
      </div>

      <!-- Certificate received? -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :cert_received, "Certificate of Conformance/Analysis received?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :cert_received, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :cert_received, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
        <div class="w-full"></div>
        <div class="col-span-2">
          <%= field_error_for(@delivery_inspection, :cert_received) %>
        </div>
      </div>

      <!-- Evidence of damage? -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :damage, "Evidence of damage?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :damage, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :damage, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
        <div class="w-full"></div>
        <div class="col-span-2">
          <%= field_error_for(@delivery_inspection, :damage) %>
        </div>
      </div>

      <!-- Foreign material contamination? -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :foreign_contam, "Evidence of foreign material contamination?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :foreign_contam, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :foreign_contam, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
        <div class="w-full"></div>
        <div class="col-span-2">
          <%= field_error_for(@delivery_inspection, :foreign_contam) %>
        </div>
      </div>

      <!-- Pest damage/contamination? -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :pest_contam, "Evidence of pest damage/contamination?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :pest_contam, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :pest_contam, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
        <div class="w-full"></div>
        <div class="col-span-2">
          <%= field_error_for(@delivery_inspection, :pest_contam) %>
        </div>
      </div>

      <!-- ≤48h delivery? (NOT required; no error display) -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :timely_delivery, "For starter cultures, was delivery ≤48h of despatch?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :timely_delivery, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :timely_delivery, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
      </div>

      <!-- Condition satisfactory? -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :satisfactory, "Condition satisfactory?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :satisfactory, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :satisfactory, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
        <div class="w-full"></div>
        <div class="col-span-2">
          <%= field_error_for(@delivery_inspection, :satisfactory) %>
        </div>
      </div>

       <!-- Condition satisfactory? -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :apply_hold, "Apply Hold?" %>
      </label>
      <div class="text-left flex items-center gap-6">
        <label class="flex items-center gap-2">
          <%= f.radio_button :apply_hold, true,  class: radio_input_class %>
          <span class="text-sm text-gray-700">Yes</span>
        </label>
        <label class="flex items-center gap-2">
          <%= f.radio_button :apply_hold, false, class: radio_input_class %>
          <span class="text-sm text-gray-700">No</span>
        </label>
        <div class="w-full"></div>
        <div class="col-span-2">
          <%= field_error_for(@delivery_inspection, :apply_hold) %>
        </div>
      </div>

      <!-- Comments (NOT required) -->
      <label class="text-right font-semibold text-gray-700">
        <%= f.label :comments, "Comments" %>
      </label>
      <div class="text-left">
        <%= f.text_area :comments, rows: 4, class: field_class_flex %>
        <%# no error for comments by request %>
      </div>

      <!-- Staff Check -->
<label class="text-right font-semibold text-gray-700">
  <%= f.label :staff_id, "Check By (Staff Member)" %>
</label>
<div class="text-left">
  <%= f.collection_select(:staff_id, @cheese_makers, :id, :full_name,
        { prompt: "Select your name" },
        { class: field_class_flex_med }) %>
  <%= field_error_for(@delivery_inspection, :staff_id) %>
</div>

<!-- Staff Signature -->
<div class="col-span-2">
  <div data-controller="signature"
       class="flex flex-col items-center space-y-4 p-4 border rounded-lg bg-gray-50">
    <p class="text-md font-semibold">Staff Signature</p>
    <canvas width="400" height="200"
            class="border border-gray-400 rounded bg-white shadow-sm"></canvas>
    <%= f.hidden_field :staff_signature, class: "signature-input" %>
    <button type="button"
            class="clear-signature text-sm text-gray-500 hover:text-gray-700 underline">
      Clear Signature
    </button>
    <%= field_error_for(@delivery_inspection, :staff_signature) %>
  </div>
</div>


      <!-- Back / Submit -->
      <div class="text-left">
        <%= link_to "← Back to Inspections", delivery_inspections_path, class: clear_button_class %>
      </div>
      <div class="text-left">
        <%= f.submit(@delivery_inspection.new_record? ? "Create Delivery inspection" : "Update Delivery inspection",
                     class: fill_button_class) %>
      </div>

    </div>
  <% end %>
</div>
