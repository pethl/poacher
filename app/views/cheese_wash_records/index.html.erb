
<% content_for(:page_title, "CHEESE WASH RECORDS") %>
<% content_for(:page_button, "cheese_wash_records/new") %>

<div class="mx-auto mt-4 mb-4 pl-2 w-full lg:w-2/3 text-left">
    Show:
    <%= link_to 'Started', cheese_wash_records_path(status: 'started'),
          class: "text-gray-600 font-semibold hover:underline #{params[:status] == 'started' ? 'text-blue-600 underline' : ''}" %> |
    <%= link_to 'Finished', cheese_wash_records_path(status: 'finished'),
          class: "text-gray-600 font-semibold hover:underline #{params[:status] == 'finished' ? 'text-blue-600 underline' : ''}" %> |
    <%= link_to 'All', cheese_wash_records_path,
          class: "text-gray-600 font-semibold hover:underline #{params[:status].blank? ? 'text-blue-600 underline' : ''}" %>


  <div class="mt-4">
    <h2 class="text-xl font-bold mb-2">
      <% if params[:status] == 'finished' %>
        Finished Records
      <% elsif params[:status] == 'started' %>
        Started Records
      <% else %>
        All Records
      <% end %>
    </h2>
  </div>
</div>



<div class="w-full px-4 mt-4">
  <div class="overflow-x-auto">
    <div class="flex-grow">
      <table class="mx-auto table-auto w-full lg:w-2/3 border text-sm text-center text-gray-700">
        <thead class="text-xs uppercase bg-gray-100 text-gray-600">
          <tr class="bg-gray-200 sticky top-0 z-10">
            <th class="p-2">Makesheet</th>
            <th class="p-2">Product</th>
            <th class="p-2">Batch Qty</th>
            <th class="p-2">Start Date</th>
            <th class="p-2">Finish Date</th>
            <th class="p-2">Total Washed</th>
            <th class="p-2">Remaining</th>
            <th class="p-2">Actions</th>
          </tr>
        </thead>
        <tbody class="bg-white">
          <% @cheese_wash_records.each do |record| %>
            <tr class="border-t hover:bg-gray-50">
              <td class="p-2 font-mono text-gray-700 underline underline-offset-2"><%= link_to record.makesheet.make_date_formatted, edit_cheese_wash_record_path(record) %></td>
              <td class="p-2"><%= record.makesheet.grade %></td>
              <td class="p-2"><%= record.makesheet.number_of_cheeses %></td>
              <td class="p-2"><%= record.date_batch_started %></td>
              <td class="p-2"><%= record.date_batch_finished %></td>
              <td class="p-2 font-semibold"><%= record.total_washed %></td>
              <td class="p-2 <%= record.remaining_to_wash > 0 ? 'text-green-700 font-semibold' : 'text-red-600' %>">
                  <%= record.remaining_to_wash %>
                </td>
              <td class="p-2">
                <% if record.date_batch_finished.present? %>
                  <%= link_to "View", cheese_wash_record_path(record), class: "text-indigo-600 hover:underline" %>
                <% else %>
                  <%= link_to "Edit", edit_cheese_wash_record_path(record), class: "text-indigo-600 hover:underline" %>
                <% end %>
              </td>

            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
